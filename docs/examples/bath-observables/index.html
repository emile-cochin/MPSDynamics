<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Inspecting the bath by undoing the chain mapping · MPSDynamics.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="MPSDynamics.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit">MPSDynamics.jl</span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Introduction</a></li><li><a class="tocitem" href="../../user-guide/">User Guide</a></li><li><a class="tocitem" href="../../nutshell/">In a Nutshell</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../sbm/">The Spin-Boson Model</a></li><li><a class="tocitem" href="../puredephasing/">Pure-Dephasing</a></li><li><a class="tocitem" href="../timedep/">Time-dependent Hamiltonian</a></li><li><a class="tocitem" href="../anderson-model/">The Anderson Impurity Model</a></li><li class="is-active"><a class="tocitem" href>Inspecting the bath by undoing the chain mapping</a><ul class="internal"><li><a class="tocitem" href="#The-code"><span>The code</span></a></li><li class="toplevel"><a class="tocitem" href="#References"><span>References</span></a></li></ul></li></ul></li><li><a class="tocitem" href="../../theory/">Theoretical Background</a></li><li><a class="tocitem" href="../../methods/">Methods</a></li><li><a class="tocitem" href="../../dev/">Developers</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Inspecting the bath by undoing the chain mapping</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Inspecting the bath by undoing the chain mapping</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/shareloqs/MPSDynamics/blob/master/docs/src/examples/bath-observables.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Inspecting-the-bath-by-undoing-the-chain-mapping"><a class="docs-heading-anchor" href="#Inspecting-the-bath-by-undoing-the-chain-mapping">Inspecting the bath by undoing the chain mapping</a><a id="Inspecting-the-bath-by-undoing-the-chain-mapping-1"></a><a class="docs-heading-anchor-permalink" href="#Inspecting-the-bath-by-undoing-the-chain-mapping" title="Permalink"></a></h1><p>Here we give some context on the example script provided in <code>MPSDynamics/example/bath-observables.jl</code>. This example demonstrates the setup and execution of a simulation for a two-level system coupled to an Ohmic bath at finite temperature, where we exploit the access to the chain observables to:</p><ul><li>undo the chain mapping<sup class="footnote-reference"><a id="citeref-chin_exact_2010" href="#footnote-chin_exact_2010">[chin_exact_2010]</a></sup>, thus obtaining their representation in the extended bath of T-TEDOPA <sup class="footnote-reference"><a id="citeref-tamascelli_efficient_2019" href="#footnote-tamascelli_efficient_2019">[tamascelli_efficient_2019]</a></sup>, characterized by <span>$J(\omega, \beta)$</span></li><li>inverting the thermofield transformation<sup class="footnote-reference"><a id="citeref-devega_thermo_2015" href="#footnote-devega_thermo_2015">[devega_thermo_2015]</a></sup>, thus obtaining the representation of the physical frequencies in the original environment, characterized by <span>$J(\omega)$</span></li></ul><p>T-TEDOPA allows to substitute a thermally occupied bath by an extended one, in the pure state of the vacuum, extending the bath of frequencies to negative values: the <em>creation</em> from the system of a mode of <em>negative frequency</em> in the extended bath of frequencies corresponds to the <em>absorption</em> of energy for the system from the thermally occupied modes of the environment. However, by exploiting the thermofield transformation, it is possible to recover the picture of the occupations of the steady states in the physical bath of frequencies<sup class="footnote-reference"><a id="citeref-riva_thermal_2023" href="#footnote-riva_thermal_2023">[riva_thermal_2023]</a></sup>. </p><h2 id="The-code"><a class="docs-heading-anchor" href="#The-code">The code</a><a id="The-code-1"></a><a class="docs-heading-anchor-permalink" href="#The-code" title="Permalink"></a></h2><p>We start by defining the parameters of the simulation:</p><pre><code class="language-julia">d = 10      # number of Fock states of the chain modes
N = 60      # length of the chain
α = 0.01    # coupling strength
ω0 = 0.2  # TLS gap
s = 1       # ohmicity
ωc = 1.  # Cut-off of the spectral density J(ω)
β = 20    # Thermalized environment</code></pre><p>We set the specifics of the simulation:</p><pre><code class="language-julia">method = :TDVP1         # time-evolution method
conv = 3                # bond dimension for the TDVP1
dt = 0.5                # time step
tfinal = 60.0           # simulation time
Tsteps = Int(tfinal / dt)</code></pre><p>And then compute the chain coefficients, i.e. on-site energies <span>$\epsilon_i$</span>, hopping energies <span>$t_i$</span>, and system-chain coupling <span>$c_0$</span>, that define the chain representation of the pure-dephasing model:</p><pre><code class="language-julia">cpars = chaincoeffs_finiteT(N, β; α=α, s=s, J=nothing, ωc=ωc, mc=4, mp=0, AB=nothing, iq=1, idelta=2, procedure=:Lanczos, Mmax=5000, save=false)</code></pre><p>with this, we can compute the corresponding MPO, and the initial state in MPS form (<span>$1/\sqrt{2}(|0\rangle + |1\rangle)$</span>):</p><pre><code class="language-julia">H = puredephasingmpo(ω0, d, N, cpars)

ψ = zeros(2)
ψ[1] = 1/sqrt(2)
ψ[2] = 1/sqrt(2)

A = productstatemps(physdims(H), state=[ψ, fill(unitcol(1,d), N)...])</code></pre><p>We can now define the observables we are interested in computing. Importantly, we not only compute observables related to the system, but also to the chain modes, so that we can inspect the environment.</p><pre><code class="language-julia">ob1 = OneSiteObservable(&quot;sz&quot;, sz, 1)
ob2 = OneSiteObservable(&quot;sx&quot;, sx, 1)
ob3 = OneSiteObservable(&quot;chain_mode_occupation&quot;, numb(d), (2,N+1))
ob4 = OneSiteObservable(&quot;c&quot;, crea(d), collect(2:N+1))
ob5 = OneSiteObservable(&quot;cdag&quot;, crea(d), collect(2:N+1))
ob6 = TwoSiteObservable(&quot;cdagc&quot;, crea(d), anih(d), collect(2:N+1), collect(2:N+1))
ob7 = TwoSiteObservable(&quot;cdagcdag&quot;, crea(d), crea(d), collect(2:N+1), collect(2:N+1))
ob8 = TwoSiteObservable(&quot;cc&quot;, anih(d), anih(d), collect(2:N+1), collect(2:N+1))</code></pre><p>with this we run the simulation:</p><pre><code class="language-julia"></code></pre><p>Furthermore, in the pure dephasing case, it is also possible to obtain the analytical prediction of the time evolution of the occupations of the bath&#39;s modes, so that we can compare our numerical results with the analytical ones, exploiting the Heisenberg time evolution relation: $ \frac{d \langle \hat b<em>\omega \rangle}{dt} = -i \langle[ \hat b</em>\omega, \hat H] \rangle = - i \omega \langle\hat b<em>\omega \rangle - i \frac{\langle \hat \sigma</em>z \rangle}{2} \sqrt{J(\omega, \beta)},     \
\frac{d \langle \hat n<em>\omega \rangle}{dt} = -i \langle[\hat b</em>\omega^\dagger \hat b<em>\omega, \hat H] \rangle= 2 \frac{|J(\omega,\beta)|}{\omega} \sin(\omega t). $ To this end, it is convenient to choose one of the eigenstates of \hat \sigma</em>z$ as the initial state, so that <span>$\langle \hat \sigma_z \rangle = \pm 1$</span>. By solving these differential equations, one obtains the time evolved theoretical behavior of the bath.</p><p>During a numerical simulation we work with chain of finite length <span>$N$</span>. This truncation on chain modes, introduces a sampling on the modes in the original star-like environment. To recover the frequency modes that are implicitly sampled, one has to diagonalize the tri-diagonal <span>$N\times N$</span> matrix <span>$H^\text{chain}$</span>, where the diagonal is formed by the <span>$e_n$</span> coefficients, that is the chain&#39;s frequencies, and the upper and lower diagonals by the <span>$N-1$</span> hopping coefficients <span>$t_n$</span>. The unitary matrix that defines the change of basis from the star-like to the chain-like environment is <span>$U_n$</span>, constituted by the eigenvectors of <span>$H^\text{chain}$</span>. The reverse path could also be taken: one can decide to sample the relevant frequencies in the star-like environment, and apply the inverse transformation to construct the tri-diagonal matrix defining the chain. Once the problem is mapped on the chain, the MPO representation of the new Hamiltonian follows straightforwardly.</p><p>___________________</p><h1 id="References"><a class="docs-heading-anchor" href="#References">References</a><a id="References-1"></a><a class="docs-heading-anchor-permalink" href="#References" title="Permalink"></a></h1><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-chin_exact_2010"><a class="tag is-link" href="#citeref-chin_exact_2010">chin_exact_2010</a><blockquote><p>Chin, A. W.; Rivas, Á.; Huelga, S. F.; Plenio, M. B. Exact Mapping between System-Reservoir Quantum Models and Semi-Infinite Discrete Chains Using Orthogonal Polynomials. Journal of Mathematical Physics 2010, 51 (9), 092109. https://doi.org/10.1063/1.3490188.</p></blockquote></li><li class="footnote" id="footnote-tamascelli_efficient_2019"><a class="tag is-link" href="#citeref-tamascelli_efficient_2019">tamascelli_efficient_2019</a><blockquote><p>Tamascelli, D.; Smirne, A.; Lim, J.; Huelga, S. F.; Plenio, M. B. Efficient Simulation of Finite-Temperature Open Quantum Systems. Phys. Rev. Lett. 2019, 123 (9), 090402. https://doi.org/10.1103/PhysRevLett.123.090402.</p></blockquote></li><li class="footnote" id="footnote-devega_thermo_2015"><a class="tag is-link" href="#citeref-devega_thermo_2015">devega_thermo_2015</a><blockquote><p>de Vega, I.; Banuls, M-.C. Thermofield-based chain-mapping approach for open quantum systems. Phys. Rev. A 2015, 92 (5), 052116. https://doi.org/10.1103/PhysRevA.92.052116.</p></blockquote></li><li class="footnote" id="footnote-riva_thermal_2023"><a class="tag is-link" href="#citeref-riva_thermal_2023">riva_thermal_2023</a><blockquote><p>Riva, A.; Tamascelli, D.; Dunnett, A. J.; Chin, A. W. Thermal cycle and polaron formation in structured bosonic environments. Phys. Rev. B 2023, 108, 195138, https://doi.org/10.1103/PhysRevB.108.195138.</p></blockquote></li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../anderson-model/">« The Anderson Impurity Model</a><a class="docs-footer-nextpage" href="../../theory/">Theoretical Background »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Wednesday 15 May 2024 13:40">Wednesday 15 May 2024</span>. Using Julia version 1.7.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
